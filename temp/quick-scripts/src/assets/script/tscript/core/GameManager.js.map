{"version":3,"sources":["assets\\script\\tscript\\core\\GameManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import PopupText from \"../ui/common/PopupText\";\r\nimport ResourcesPool from \"./ResourcesPool\";\r\nimport ResourcesManager from \"./ResourcesManager\";\r\nimport Knife, { KnifeType } from \"../gamescene/Knife\";\r\nimport GameScene from \"../gamescene/GameScene\";\r\nimport Mark from \"../gamescene/Mark\";\r\nimport Player from \"../gamescene/Player\";\r\nimport DataManager from \"./DataManager\";\r\nimport Joystick from \"../gamescene/Joystick\";\r\nimport Guide from \"../gamescene/Guide\";\r\nimport MovieClip from \"../util/MovieClip\";\r\nimport Barrier from \"../gamescene/Barrier\";\r\nimport Random from \"../util/Random\";\r\nimport BlackHole from \"../gamescene/BlackHole\";\r\nimport Item, { ItemType } from \"../item/Item\";\r\n\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nexport enum GameStatus\r\n{\r\n    none = 0,\r\n    start = 1,\r\n    over = 2,\r\n}\r\n\r\n@ccclass\r\nexport default class GameManager extends cc.Component {\r\n\r\n    private static _instance: GameManager;\r\n    public static get instance(): GameManager {\r\n        /*if(this._instance == null)\r\n        {\r\n            this._instance = new GameManager();\r\n            this._instance.init();\r\n        }*/\r\n        return GameManager._instance;\r\n    }\r\n\r\n\r\n    @property(cc.Node)\r\n    public canvas:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    public gameScene:cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    public touchPlane:cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    public playerPrefab:cc.Prefab = null;\r\n\r\n\r\n    @property(cc.Prefab)\r\n    public knifePrefab:cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    public markPrefab:cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    public killEffectPrefab:cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    public blackHolePrefab:cc.Prefab = null;\r\n\r\n    @property(Joystick)\r\n    public joystick:Joystick = null; \r\n\r\n    @property(Guide)\r\n    public guide:Guide = null; \r\n\r\n    @property(cc.SpriteFrame)\r\n    public bgImgs:cc.SpriteFrame[] = [];\r\n\r\n    @property(cc.SpriteFrame)\r\n    public daoImgs:cc.SpriteFrame[] = [];\r\n\r\n    @property(cc.SpriteFrame)\r\n    public levelImgs:cc.SpriteFrame[] = [];\r\n\r\n    @property(cc.Prefab)\r\n    public barrierPrefabArr:cc.Prefab[] = []; \r\n\r\n    @property(cc.Prefab)\r\n    public itemPrefabArr:cc.Prefab[] = []; \r\n    \r\n\r\n    public gameStatus:GameStatus = GameStatus.none;\r\n\r\n\r\n    /**\r\n     * 玩家打开游戏后，玩了多少次游戏\r\n     */\r\n    public static gameTimes:number = 0;//\r\n\r\n    /*@property(Product)\r\n    private productList:Product[] = [];\r\n    private productDic:{[key:number]:Product} = {};*/\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () \r\n    {\r\n        GameManager._instance = this;\r\n        //GameManager._instance.init();\r\n    }\r\n\r\n    public init()\r\n    {\r\n        //this.canvas = cc.find(\"Canvas\");\r\n        \r\n    }\r\n\r\n    public showPopupText(position:cc.Vec2,msg:string,size:number = 32,color:cc.Color = cc.Color.YELLOW)\r\n    {\r\n        var popupText:PopupText = ResourcesPool.instance.get<PopupText>(PopupText);\r\n        \r\n        if(popupText)\r\n        {\r\n            popupText.node.setParent(this.canvas);\r\n            popupText.node.position = position;\r\n            popupText.showText(msg,size,color);\r\n        }else\r\n        {\r\n            ResourcesManager.instance.load(\"PopupText\",(node:cc.Node)=>{\r\n                popupText = node.getComponent(PopupText);\r\n                popupText.node.setParent(this.canvas);\r\n                popupText.node.position = position;\r\n                popupText.showText(msg,size,color);\r\n            });\r\n        }\r\n    }\r\n\r\n    public showPopupMsg(position:cc.Vec2,msg:string,size:number = 32,color:cc.Color = cc.Color.YELLOW)\r\n    {\r\n        \r\n    }\r\n\r\n    /**\r\n     * 获得玩家\r\n     */\r\n    public getPlayer():Player\r\n    {\r\n        var node:cc.Node = cc.instantiate(this.playerPrefab);\r\n        var player = node.getComponent(Player);\r\n        player.node.position = cc.Vec2.ZERO;\r\n        player.node.active = true;\r\n        return player;\r\n    }\r\n\r\n    /**\r\n     * 获得飞刀\r\n     */\r\n    public getKnife(type:KnifeType):Knife\r\n    {\r\n        var knife:Knife = ResourcesPool.instance.get<Knife>(Knife);\r\n\r\n        if(knife)\r\n        {\r\n            return knife;\r\n        }\r\n\r\n        var node:cc.Node = cc.instantiate(this.knifePrefab);\r\n        knife = node.getComponent(Knife);\r\n        knife.node.position = cc.Vec2.ZERO;\r\n        knife.type = type;\r\n        knife.node.active = true;\r\n\r\n        return knife;\r\n    }\r\n\r\n    /**\r\n     * 获得飞刀\r\n     */\r\n    public getMark():Mark\r\n    {\r\n        var node:cc.Node = cc.instantiate(this.markPrefab);\r\n        var mark = node.getComponent(Mark);\r\n        mark.node.position = cc.Vec2.ZERO;\r\n        mark.node.active = true;\r\n        return mark;\r\n    }\r\n\r\n    /**\r\n     * 获得飞刀\r\n     */\r\n    public getKillEffect():MovieClip\r\n    {\r\n        var node:cc.Node = cc.instantiate(this.killEffectPrefab);\r\n        var mc = node.getComponent(MovieClip);\r\n        mc.node.position = cc.Vec2.ZERO;\r\n        mc.node.active = true;\r\n        return mc;\r\n    }\r\n\r\n    public getRandomBarrier(type:number):cc.Node\r\n    {\r\n        var node:cc.Node = null;\r\n\r\n        if(type == 0)\r\n        {\r\n            node = cc.instantiate(this.barrierPrefabArr[Random.RangeInteger(0,4)]);\r\n        }else\r\n        {\r\n            node = cc.instantiate(this.barrierPrefabArr[Random.RangeInteger(4,this.barrierPrefabArr.length)]);\r\n        }\r\n\r\n        node.position = cc.Vec2.ZERO;\r\n        node.rotation = Random.RangeInteger(0,360);\r\n        node.active = true;\r\n        return node;\r\n    }\r\n\r\n    public getBlackHole():BlackHole\r\n    {\r\n        var node:cc.Node = cc.instantiate(this.blackHolePrefab);\r\n        node.position = cc.Vec2.ZERO;\r\n        node.active = true;\r\n        return node.getComponent(BlackHole);\r\n    }\r\n\r\n\r\n    /**\r\n     * 获得飞刀\r\n     */\r\n    public getItemByType(type:ItemType):Item\r\n    {\r\n        var node:cc.Node = cc.instantiate(this.itemPrefabArr[type - 1]);\r\n        node.position = cc.Vec2.ZERO;\r\n        node.active = true;\r\n        return node.getComponent(Item);\r\n    }\r\n\r\n    /*start () {\r\n\r\n    }*/\r\n\r\n    // update (dt) {}\r\n}\r\n"]}