{"version":3,"sources":["assets\\script\\tscript\\Main.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import PlayerData from \"./data/PlayerData\";\r\nimport DataManager from \"./core/DataManager\";\r\nimport GameScene from \"./gamescene/GameScene\";\r\nimport GameManager from \"./core/GameManager\";\r\nimport WXSdk from \"./wx/WXSdk\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Main extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    public canvas:cc.Node = null;\r\n\r\n\t @property(cc.Sprite)\r\n    public bgcion:cc.Sprite = null;\r\n\t\r\n\t @property(cc.SpriteFrame)\r\n    public bg1:cc.SpriteFrame = null;\r\n\t\r\n\t @property(cc.SpriteFrame)\r\n    public bg2:cc.SpriteFrame = null;\r\n\t\r\n    private gameMagr:GameManager;\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () \r\n     {\r\n\t\twindow.main = this;\r\n       cc.game.setFrameRate(60);\r\n       this.gameMagr = this.canvas.getComponent<GameManager>(GameManager);\r\n       this.canvas.active = false;\r\n\r\n       DataManager.instance.loadConfigDatas(this.onloadConfigDatas);\r\n\r\n\t   this.randombg();\r\n\t   \r\n\t  \r\n       \r\n    }\r\n    \r\n    private onloadConfigDatas = function()\r\n    {\r\n        this.gameMagr.init();\r\n        this.canvas.active = true;\r\n        //SoundManager.instance.PlayBGSound(BgSoundClipType.main);\r\n        this.loginWx();\r\n    }.bind(this);\r\n\r\n\r\n    private loginWx()\r\n    {\r\n        WXSdk.instance.login(\r\n            \"ss\",\r\n            \"ss\",\r\n         ()=>{\r\n\r\n             if(WXSdk.instance.isWXPlatform())\r\n             {\r\n                cc.log(\"微信登录成功\");\r\n                console.log(\"发送微信事件\");\r\n                var baseData = \r\n                {\r\n                    name:\"init\",\r\n                    levelConfigDatas:DataManager.instance.levelConfigDatas\r\n                }\r\n\r\n                WXSdk.instance.wx.postMessage(baseData); //向开发数据域发送初始数据\r\n\r\n                cc.systemEvent.emit(\"wxLogin\");\r\n                WXSdk.instance.wx.showToast({\r\n                    title: '登录成功',\r\n                    icon: 'success',\r\n                    duration: 2000\r\n                })\r\n\r\n             }\r\n             \r\n         },()=>{\r\n\r\n            if(WXSdk.instance.isWXPlatform())\r\n            {\r\n                cc.log(\"微信登录失败\");\r\n                this.showModal();\r\n            }\r\n         });\r\n    }\r\n\r\n    private showModal()\r\n    {\r\n        WXSdk.instance.wx.showModal({\r\n            title: '异常',\r\n            showCancel:false,\r\n            confirmText:\"重试\",\r\n            content: '游戏登录失败，请重试',\r\n            success:(res)=>\r\n            {\r\n                 if (res.confirm)\r\n                {\r\n                    this.loginWx();\r\n                }else\r\n                {\r\n                    this.loginWx();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n\t\r\n\trandombg()\r\n\t{\r\n\t\t if( Math.random()>0.5 )\r\n\t   {\r\n\t\t    this.bgcion.spriteFrame = this.bg2;\r\n\t   }else\r\n\t   {\r\n\t\t    this.bgcion.spriteFrame = this.bg1;\r\n\t   }\r\n\t}\r\n\r\n    // update (dt) {}\r\n\r\n    \r\n}\r\n"]}