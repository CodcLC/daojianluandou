{"version":3,"sources":["assets\\script\\tscript\\util\\Clock.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Clock extends cc.Component {\r\n\r\n    /// <summary>\r\n    /// 1只显示秒，2只显示分秒，3只显示时分秒\r\n    /// </summary>\r\n    @property({type:cc.Integer,tooltip:\"1只显示秒，2只显示分秒，3只显示时分秒\"})\r\n    public hms:number = 3;\r\n\r\n    @property({type:cc.Label,tooltip:\"显示倒计时的文本\"})\r\n    public timeText:cc.Label = null;\r\n\r\n    /// <summary>\r\n    /// 0是倒计时，1是顺计时\r\n    /// </summary>\r\n    @property({type:cc.Integer,tooltip:\"0是倒计时，1是顺计时\"})\r\n    public increse:number = 0;\r\n\r\n    /// <summary>\r\n    /// 时长\r\n    /// </summary>\r\n    @property({type:cc.Integer,tooltip:\"时长\"})\r\n    public timeLength:number = 0;\r\n\r\n    /// <summary>\r\n    /// 每个时间步的间隔，单位为秒\r\n    /// </summary>\r\n    @property({type:cc.Integer,tooltip:\"每个时间步的间隔，单位为秒\"})\r\n    public timeStep:number = 1.0;\r\n\r\n    private _stime:number = 0;\r\n    private _etime:number = 0;\r\n\r\n    private _currentCount:number = 0;\r\n\r\n    private _hour:number = 0;//时\r\n    private _minute:number = 0;//分\r\n    private _second:number = 0;//秒\r\n\r\n    private _isStop:boolean = true;\r\n\r\n    /// <summary>\r\n    /// 没一个时间步执行的会掉\r\n    /// </summary>\r\n    private  _callback:Function = null;\r\n\r\n    /// <summary>\r\n    /// 时间结束时执行的回调\r\n    /// </summary>\r\n    private _completeCallback:Function = null;\r\n\r\n    /// <summary>\r\n    /// 开始计时\r\n    /// </summary>\r\n    /// <param name=\"callback\">计时执行的回调</param>\r\n    public Play(callback:Function = null, completeCallback:Function = null)\r\n    {\r\n        if(!this.timeText)\r\n        {\r\n            this.timeText = this.getComponent(cc.Label);\r\n        }\r\n\r\n        this._callback = callback;\r\n        this._completeCallback = completeCallback;\r\n        this._isStop = false;\r\n        this.unschedule(this.ClockTime);\r\n        this.ClockTime(this.timeStep);\r\n        this.schedule(this.ClockTime,this.timeStep);\r\n    }\r\n\r\n    /// <summary>\r\n    /// 停止计时\r\n    /// </summary>\r\n    public Stop()\r\n    {\r\n        this.unschedule(this.ClockTime);\r\n        this._isStop = true;\r\n    }\r\n\r\n    /// <summary>\r\n    /// 计时重置\r\n    /// </summary>\r\n    public Reset()\r\n    {\r\n        this._currentCount = 0;\r\n        this._isStop = true;\r\n    }\r\n\r\n\r\n    /// <summary>\r\n    /// 时钟计时\r\n    /// </summary>\r\n    /// <returns></returns>\r\n    private ClockTime(dt:number)\r\n    {\r\n        if (this._isStop)\r\n        {\r\n            this.unschedule(this.ClockTime);\r\n            return;\r\n        }\r\n\r\n        if(this._currentCount < this.timeLength)\r\n        {\r\n            this._currentCount++;\r\n\r\n            var num:number = 0;\r\n\r\n            if (this.increse == 1)\r\n            {\r\n                num = this._stime + this._currentCount;\r\n            }\r\n            else if (this.increse == 0)\r\n            {\r\n                num = this.timeLength - this._currentCount + this._stime;\r\n            }\r\n            else\r\n            {\r\n                this.unschedule(this.ClockTime);\r\n                return;\r\n            }\r\n\r\n            //this._hour = Math.floor(num / 3600) % 24;//转换小时 24小时制\r\n            this._hour = Math.floor(num / 3600);//转换小时 \r\n            this._minute = Math.floor((num - this.hour * 3600) / 60);//转换分钟\r\n            this._second = num - (this.hour * 3600 + this.minute * 60);//转换秒数\r\n\r\n            var str:string = \"\";\r\n            if (this.hms == 1)\r\n            {\r\n                str = this.second >= 10 ? \"\" + this.second : \"0\" + this.second;\r\n            }\r\n            else if (this.hms == 2)\r\n            {\r\n                str = this.minute + \":\" + (this.second >= 10 ? \"\" + this.second : \"0\" + this.second);\r\n            }\r\n            else if (this.hms == 3)\r\n            {\r\n                str = (this.hour >= 10 ? this.hour + \":\" : \"0\" + this.hour + \":\") +\r\n                    (this.minute >= 10 ? this.minute + \":\" : \"0\" + this.minute + \":\") + (this.second >= 10 ? \"\" + this.second : \"0\" + this.second);\r\n            }\r\n\r\n            if (this._callback != null)\r\n            {\r\n                this._callback(this.second, this.minute, this.hour, str,num);\r\n            }\r\n\r\n            if (this.timeText != null)\r\n            {\r\n                this.timeText.string = str;\r\n            }\r\n        }else\r\n        {\r\n            this._isStop = true;\r\n\r\n            if (this._completeCallback != null)\r\n            {\r\n                this._completeCallback();\r\n            }\r\n    \r\n            this.unschedule(this.ClockTime);\r\n            return;\r\n        }\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 当前计时了多少步\r\n    /// </summary>\r\n    public get currentCount()\r\n    {\r\n        return this._currentCount;\r\n    }\r\n\r\n    /// <summary>\r\n    /// 小时\r\n    /// </summary>\r\n    public get hour():number\r\n    {\r\n\r\n        return this._hour;\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 分钟\r\n    /// </summary>\r\n    public get minute():number\r\n    {\r\n        return this._minute;\r\n    }\r\n\r\n    /// <summary>\r\n    /// 秒钟\r\n    /// </summary>\r\n    public get second():number\r\n    {\r\n\r\n        return this._second;\r\n    }\r\n\r\n    public get running():boolean\r\n    {\r\n        return !this._isStop;\r\n    }\r\n\r\n    onLoad()\r\n    {\r\n        if(!this.timeText)\r\n        {\r\n            this.timeText = this.getComponent(cc.Label);\r\n        }\r\n    }\r\n\r\n    start () {\r\n\r\n        \r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}