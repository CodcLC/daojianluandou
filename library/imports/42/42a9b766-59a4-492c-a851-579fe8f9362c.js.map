{"version":3,"sources":["assets\\script\\tscript\\gamescene\\Knife.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Mathf from \"../util/Mathf\";\r\nimport ResourcesPool, { Recycle } from \"../core/ResourcesPool\";\r\nimport Player, { PlayerStatus } from \"./Player\";\r\nimport Random from \"../util/Random\";\r\nimport KnifePool from \"./KnifePool\";\r\nimport GameManager, { GameStatus } from \"../core/GameManager\";\r\nimport GameScene from \"./GameScene\";\r\nimport ResourcesManager from \"../core/ResourcesManager\";\r\nimport WXSdk from \"../wx/WXSdk\";\r\nimport BlackHole from \"./BlackHole\";\r\nimport CameraFollow from \"./CameraFollow\";\r\nimport SoundManager from \"../core/SoundManager\";\r\nimport { SoundClipType } from \"../audio/SoundClip\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nexport enum KnifeType\r\n{\r\n    normal = 0,\r\n    red = 1,\r\n    green = 2,\r\n}\r\n\r\nexport enum KnifeStatus\r\n{\r\n    normal = 0,\r\n    capture = 1,\r\n    fly = 2,\r\n    absorb = 3,\r\n}\r\n\r\n@ccclass\r\nexport default class Knife extends cc.Component implements Recycle {\r\n\r\n    @property({type:cc.Enum(KnifeType)})\r\n    type:KnifeType = KnifeType.normal;\r\n\r\n    @property(cc.Sprite)\r\n    skin:cc.Sprite = null;\r\n\r\n    public status:KnifeStatus = KnifeStatus.normal;\r\n\r\n    public player:Player = null; \r\n\r\n    public damage:number = 30;\r\n\r\n    private baseScale:number;\r\n\r\n    private rotaSpeed = 90;\r\n    private rotaAngle:number = 0;\r\n\r\n    private targetAngle:number = 0;\r\n\r\n    private targetPos:cc.Vec2 = cc.Vec2.ZERO;\r\n\r\n    private halfSize:cc.Size = cc.Size.ZERO;\r\n\r\n    private gameScene:GameScene;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n     onLoad () \r\n     {\r\n        this.baseScale = this.node.scale;\r\n        //this.setSkin(2,5);\r\n     }\r\n\r\n    start () {\r\n\r\n        this.gameScene = GameManager.instance.gameScene.getComponent(GameScene);\r\n\r\n        this.skin.node.width = this.skin.spriteFrame.getRect().width;\r\n        this.skin.node.height = this.skin.spriteFrame.getRect().height;\r\n\r\n        /*this.setPos(cc.v2(Random.Range(-250,250),Random.Range(-250,250)));\r\nthis.schedule(()=>{\r\n    \r\n    this.setPos(cc.v2(Random.Range(-250,250),Random.Range(-250,250)));\r\n},2.5);*/\r\n    }\r\n\r\n    public setSkin(id:number)\r\n    {\r\n        /*ResourcesManager.instance.load(`knife/dao_${id - 1}`,(spriteFrame:cc.SpriteFrame)=>{\r\n\r\n            if(spriteFrame)\r\n            {\r\n                this.skin.spriteFrame = spriteFrame;\r\n                \r\n                this.skin.node.width = spriteFrame.getRect().width;\r\n                this.skin.node.height = spriteFrame.getRect().height;\r\n                //this.skin.node.width = 500\r\n\r\n            }\r\n\r\n        },cc.SpriteFrame,true,false)*/\r\n\r\n        var spriteFrame:cc.SpriteFrame = GameManager.instance.daoImgs[id-1];\r\n\r\n        this.skin.spriteFrame = spriteFrame;\r\n                \r\n        this.skin.node.width = spriteFrame.getRect().width;\r\n        this.skin.node.height = spriteFrame.getRect().height;\r\n\r\n    }\r\n\r\n    update (dt) \r\n    {\r\n        /*var speed = dt * this.rotaSpeed;\r\n\r\n        var dir = this.targetAngle - this.node.rotation;\r\n\r\n        if(speed > Math.abs(dir))\r\n        {\r\n            this.node.rotation = this.targetAngle;\r\n            //cc.log(\"dddd\");\r\n        }else\r\n        {\r\n            if(dir > 0)\r\n            {\r\n                this.node.rotation += speed;\r\n            }else\r\n            {\r\n                this.node.rotation -= speed;\r\n            }\r\n            \r\n        }*/\r\n\r\n        if(this.node.parent == GameManager.instance.gameScene)\r\n        {\r\n\r\n            this.halfSize.width = (this.gameScene.sceneSize.width - this.node.width) / 2 ;\r\n            this.halfSize.height = (this.gameScene.sceneSize.height - this.node.height) / 2 ;\r\n\r\n            var pos:cc.Vec2 = this.node.position;\r\n\r\n            if(pos.x < -this.halfSize.width)\r\n            {\r\n                pos.x = -this.halfSize.width;\r\n            }else if(pos.x > this.halfSize.width)\r\n            {\r\n                pos.x = this.halfSize.width;\r\n            }\r\n\r\n            if(pos.y < -this.halfSize.height)\r\n            {\r\n                pos.y = -this.halfSize.height;\r\n            }else if(pos.y > this.halfSize.height)\r\n            {\r\n                pos.y = this.halfSize.height;\r\n            }\r\n\r\n            this.node.position = pos;\r\n        }\r\n    }\r\n\r\n    public onCollisionEnter(other:cc.Collider,self:cc.Collider)\r\n    {\r\n\r\n        if(other.tag == 0)\r\n        {\r\n        }else if(other.tag == 1)\r\n        {\r\n            if(this.status == KnifeStatus.capture)\r\n            {\r\n                var knife:Knife = other.getComponent(Knife);\r\n            \r\n                //cc.log(\"碰撞到了 other \",knife,this,knife.status,knife.status == KnifeStatus.capture,KnifeStatus.fly);\r\n\r\n                if(knife && knife.status == KnifeStatus.capture && knife.player && knife.player != this.player)\r\n                {\r\n\r\n                    if(!this.player.isAI || !knife.player.isAI)\r\n                    {\r\n                        WXSdk.instance.vibrateShort();\r\n                        CameraFollow.instance.shake();\r\n                        SoundManager.instance.playAudioClip(SoundClipType.kfhit);\r\n                    }\r\n\r\n                    //cc.log(\"hit other \",knife,knife.status);\r\n                    var dir:cc.Vec2 = this.node.position.sub(knife.node.position).normalize();\r\n\r\n                    if(knife.player.status == PlayerStatus.attack)\r\n                    {\r\n                        knife.fly(dir.mul(-1));\r\n                    }\r\n\r\n                    if(this.player.status == PlayerStatus.attack)\r\n                    {\r\n                        this.fly(dir);\r\n                    }\r\n                    \r\n                }\r\n            }\r\n\r\n        }else if(other.tag == 2)//碰到了障碍物\r\n        {\r\n            if(this.status == KnifeStatus.capture || this.status == KnifeStatus.fly)\r\n            {\r\n\r\n                if(this.player && !this.player.isAI)\r\n                {\r\n                    WXSdk.instance.vibrateShort();\r\n                    CameraFollow.instance.shake();\r\n                    SoundManager.instance.playAudioClip(SoundClipType.kfhit);\r\n                }\r\n\r\n                var dir:cc.Vec2 = this.node.position.sub(other.node.position).normalize();\r\n                this.fly(dir);\r\n\r\n            }\r\n            \r\n        }else if(other.tag == 5) //碰撞刀了黑洞\r\n        {\r\n            this.absorbed(other.node.parent.getComponent(BlackHole));\r\n        }\r\n        \r\n    }\r\n\r\n    public fly(dir:cc.Vec2 = cc.Vec2.ONE)\r\n    {\r\n        if(this.status == KnifeStatus.capture)\r\n        {\r\n            this.status = KnifeStatus.fly;\r\n            var pool:KnifePool = this.node.parent.getComponent(KnifePool);\r\n\r\n            if(pool)\r\n            {\r\n                pool.removeKnife(this);\r\n            }\r\n        }\r\n\r\n        \r\n        if(this.node.parent != GameManager.instance.gameScene)\r\n        {\r\n            var worldPos:cc.Vec2 = this.node.parent.convertToWorldSpaceAR(this.node.position);\r\n            var relaPos:cc.Vec2 = GameManager.instance.gameScene.convertToNodeSpaceAR(worldPos);\r\n            this.node.position = relaPos;\r\n        }\r\n\r\n        this.node.parent = GameManager.instance.gameScene;\r\n        this.player = null;\r\n\r\n        this.node.stopAllActions();\r\n\r\n        this.node.scale = 1;\r\n\r\n        var t = Random.Range(0.65,1.0)\r\n        var spawn = cc.spawn(cc.moveBy(t,dir.mul(Random.Range(360,540))).easing(cc.easeCubicActionOut()),cc.rotateBy(t,1080).easing(cc.easeCubicActionOut()));\r\n        var seq = cc.sequence(spawn,cc.callFunc(()=>{\r\n\r\n            this.status = KnifeStatus.normal;\r\n            GameManager.instance.gameScene.getComponent(GameScene).addKnife(this);\r\n\r\n        },this));\r\n\r\n        this.node.runAction(seq);\r\n\r\n    }\r\n\r\n\r\n    public absorbed(blackhole:BlackHole)\r\n    {\r\n        if(!blackhole.appear)\r\n            return;\r\n\r\n        if(this.status == KnifeStatus.absorb)\r\n            return;\r\n\r\n        if(this.status == KnifeStatus.capture)\r\n        {\r\n            var pool:KnifePool = this.node.parent.getComponent(KnifePool);\r\n            if(pool)\r\n            {\r\n                pool.removeKnife(this);\r\n            }\r\n        }\r\n\r\n        this.status = KnifeStatus.absorb;\r\n\r\n        if(this.node.parent != blackhole.node)\r\n        {\r\n            var worldPos:cc.Vec2 = this.node.parent.convertToWorldSpaceAR(this.node.position);\r\n            var relaPos:cc.Vec2 = blackhole.node.convertToNodeSpaceAR(worldPos);\r\n            this.node.position = relaPos;\r\n        }\r\n\r\n\r\n        this.node.parent = blackhole.node;\r\n        this.player = null;\r\n\r\n        this.node.stopAllActions();\r\n\r\n        this.node.scale = 1;\r\n\r\n        //var dir:cc.Vec2 = cc.Vec2.ZERO.sub(cc.v2(1,0)).normalize();\r\n        var dir:cc.Vec2 = cc.Vec2.ZERO.sub(this.node.position).normalize();\r\n\r\n        var eulerAngle:number = 90 - Math.atan2(dir.y,dir.x) * 180/Math.PI ;\r\n\r\n        this.node.runAction(cc.rotateTo(0.15,eulerAngle));\r\n        //this.node.rotation = eulerAngle;\r\n\r\n        var t = Random.Range(0.65,1.0)\r\n        \r\n        var spawnAction = cc.spawn(cc.moveTo(0.45,cc.Vec2.ZERO),cc.fadeTo(0.45,25),cc.scaleTo(0.45,0.25));\r\n\r\n        var seq = cc.sequence(spawnAction,cc.callFunc(()=>{\r\n\r\n            blackhole.eat(this);\r\n            this.status = KnifeStatus.normal;\r\n            GameManager.instance.gameScene.getComponent(GameScene).removeKnife(this);\r\n            this.destroySelf();\r\n\r\n        },this));\r\n\r\n        this.node.runAction(seq);\r\n\r\n        \r\n\r\n    }\r\n\r\n\r\n    public setRota(eulerAngle:number)\r\n    {\r\n        //this.targetAngle = eulerAngle;\r\n\r\n        //this.node.stopAllActions();\r\n\r\n        if(GameManager.instance.gameStatus == GameStatus.start)\r\n        {\r\n            this.node.runAction(cc.rotateTo(0.1,eulerAngle));\r\n        }else\r\n        {\r\n            //this.node.rotation = eulerAngle;\r\n            //this.node.runAction(cc.rotateTo(0.05,eulerAngle));\r\n            this.node.runAction(cc.rotateTo(0.1,eulerAngle));\r\n        }\r\n\r\n        \r\n        //this.node.rotation = eulerAngle;\r\n\r\n    }\r\n\r\n    public setPos(pos:cc.Vec2)\r\n    {\r\n        //this.targetPos = pos;\r\n\r\n        var t =  this.node.position.sub(pos).mag() / 1000;\r\n\r\n        //t = 0.3;\r\n        this.node.runAction(cc.moveTo(t,pos));\r\n        //this.node.position = pos;\r\n    }\r\n\r\n    public rotateTowards()\r\n    {\r\n\r\n    }\r\n\r\n    public setScale(size:number)\r\n    {\r\n\r\n        //this.node.scale = size;\r\n        this.node.scale = this.baseScale * size;\r\n\r\n    }\r\n\r\n\r\n    public getKey():string\r\n    {\r\n        \r\n        //return PopupText.name;\r\n        return \"Knife\";\r\n    }\r\n\r\n    public awake()\r\n    {\r\n        this.node.position = cc.Vec2.ZERO;\r\n        this.node.active = true;\r\n        this.node.color = cc.Color.WHITE;\r\n        this.node.opacity = 255;\r\n        this.node.scale = 1;\r\n        this.status = KnifeStatus.normal;\r\n        this.gameScene = GameManager.instance.gameScene.getComponent(GameScene);\r\n    }\r\n    public sleep()\r\n    {\r\n        this.node.stopAllActions();\r\n        this.node.parent = null;\r\n        this.node.active = false;\r\n        this.status = KnifeStatus.normal;\r\n    }\r\n\r\n    public destroySelf()\r\n    {\r\n        ResourcesPool.instance.put(this,50);\r\n    }\r\n\r\n}\r\n"]}