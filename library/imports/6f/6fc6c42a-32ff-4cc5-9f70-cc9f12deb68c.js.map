{"version":3,"sources":["assets\\script\\tscript\\wx\\WXSdk.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import SystemTools from \"./SystemTools\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\ndeclare var wx:any;\r\n\r\n/**\r\n * 用户授权状态\r\n */\r\nexport enum AuthorizeStatus\r\n{\r\n    /**\r\n     * 未申请授权\r\n     */\r\n    none = 0,\r\n\r\n    /**\r\n     * 拒绝授权\r\n     */\r\n    refuse = 1,\r\n\r\n    /**\r\n     * 同意授权\r\n     */\r\n    agree = 2\r\n\r\n}\r\n\r\n\r\n@ccclass\r\nexport default class WXSdk extends cc.Component {\r\n\r\n   private static _instance: WXSdk;\r\n    public static get instance(): WXSdk {\r\n        if(!this._instance)\r\n        {\r\n            this._instance = new WXSdk();\r\n            this._instance.init();\r\n        }\r\n        return WXSdk._instance;\r\n    }\r\n\r\n    public wx:any;\r\n\r\n    //public url:string = \"http://127.0.0.1:8080/knife/login\";\r\n\r\n    public url:string = \"https://127.0.0.1/knife/login\";\r\n\r\n    public worldRankUrl:string = \"https://127.0.0.1/knife/update-best-score\";\r\n    public worldRankUrl2:string = \"https://127.0.0.1/knife/world/\";\r\n\r\n\r\n    private appid:string = \"wx472e16802f66329a\"; // 小程序 appId\r\n    private secret:string = \"\"; // 小程序 appSecret\r\n    private grant_type:string = \"authorization_code\"; //填写为 authorization_code\r\n    //private grant_type:string = \"client_credential\"\r\n    //0c8f46b257766254c31dccf5e345945a\r\n\r\n    private _openDataContext:any;\r\n\r\n    private _sharedCanvas:any;\r\n\r\n    private _systemInfo: any;\r\n\r\n    private _bannerAd:any;\r\n\r\n    private _userData:any;\r\n\r\n    private _userInfo:any;\r\n\r\n    private _accessTokenData:any;\r\n\r\n    private _authorizeStatus: AuthorizeStatus = AuthorizeStatus.none;\r\n\r\n    private _tokenData:any = \"\";\r\n\r\n    private isVibrate:boolean = false;\r\n\r\n    public isLogin:boolean = false;\r\n\r\n    private shareTime:number = 0;\r\n\r\n    /*private wxLog(message?: any, ...optionalParams: any[])\r\n    {\r\n        console.log(message,optionalParams);\r\n    }*/\r\n\r\n    private wxLog = console.log;\r\n    //private wxLog = function(...args){};\r\n\r\n    private _shareTicket:string = \"\";\r\n\r\n    private init()\r\n    {\r\n        //this.wx = window[\"wx\"] || {};\r\n        //this.wx = wx || {};\r\n        this.wx = window[\"wx\"];\r\n        //this.wxLog(\"wx = \",this.wx);\r\n\r\n        this.systemInfo;\r\n\r\n        if(this.wx)\r\n        {\r\n            this.wx.onShow((res)=>{\r\n\r\n                if(res.query.type == \"shareToAnyOne\" && res.scene == 1044)\r\n                {\r\n                    this._shareTicket = res.shareTicket;\r\n                    cc.systemEvent.emit(\"shareTicketUpdate\");\r\n                    \r\n                }else\r\n                {\r\n                    this._shareTicket = \"\";\r\n                }\r\n\r\n                //this.wxLog(\"onShow 收到消息\",res,\"this._shareTicket\",this._shareTicket);\r\n\r\n            });\r\n    \r\n            this.wx.onHide((res)=>{\r\n\r\n                //this.wxLog(\"onHide 收到消息\",res);\r\n\r\n            });\r\n\r\n            var launchOption = this.wx.getLaunchOptionsSync();\r\n\r\n            if(launchOption.shareTicket && launchOption.shareTicket != \"<Undefined>\")\r\n            {\r\n                this._shareTicket = launchOption.shareTicket;\r\n            }else\r\n            {\r\n                this._shareTicket = \"\";\r\n            }\r\n\r\n            //shareTick \"<Undefined>\"\r\n            //this.wxLog(\"launchOption = \",launchOption);\r\n\r\n            this.wx.showShareMenu({\r\n                withShareTicket: true,\r\n                success:()=>{},\r\n                fail:()=>{},\r\n            });\r\n\r\n            this.wx.onShareAppMessage(() => ({\r\n                title: '刀剑乱斗英雄',\r\n                imageUrl: 'https://127.0.0.1/image/星球飞刀.jpg', // 图片 URL\r\n                query: \"type=shareToAnyOne\",\r\n            }))\r\n\r\n        }\r\n\r\n    }\r\n\r\n    public isWXPlatform():boolean\r\n    {\r\n        return this.wx != undefined && this.wx != null;\r\n    }\r\n\r\n    public get openDataContext() : any\r\n    {\r\n        if(!this._openDataContext)\r\n        {\r\n            this._openDataContext = this.wx.getOpenDataContext();\r\n        }\r\n        return this._openDataContext;\r\n    }\r\n\r\n    public get sharedCanvas() : any\r\n    {\r\n        if(!this._sharedCanvas)\r\n        {\r\n            this._sharedCanvas = this.openDataContext.canvas;\r\n        }\r\n\r\n        return this._sharedCanvas;\r\n    }\r\n\r\n    // update (dt) {}\r\n\r\n    public get systemInfo(): any {\r\n\r\n        if(this.wx && !this._systemInfo)\r\n        {\r\n            this._systemInfo = this.wx.getSystemInfoSync();\r\n            this.wxLog(\"微信系统信息\",this._systemInfo);\r\n            this.wxLog(\r\n                \"\\n手机型号\",this._systemInfo.model,\r\n                \"\\n系统\",this._systemInfo.system,\r\n                \"\\n微信版本\",this._systemInfo.version,\r\n                \"\\n语言\",this._systemInfo.language,\r\n                \"\\n手机品牌\",this._systemInfo.brand,\r\n                \"\\n客户端平台\",this._systemInfo.platform,\r\n                \"\\n客户端基础库版本\",this._systemInfo.SDKVersion\r\n                );\r\n        }\r\n\r\n        return this._systemInfo;\r\n    }\r\n\r\n    /**\r\n     * 微信版本号\r\n     */\r\n    public get version():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.version;\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 微信基础库版本\r\n     */\r\n    public get SDKVersion():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.SDKVersion;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 手机系统\r\n     */\r\n    public get system():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.system;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 手机型号\r\n     */\r\n    public get model():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.model;\r\n        }\r\n        return this.systemInfo.model;\r\n    }\r\n\r\n    /**\r\n     * 手机品牌\r\n     */\r\n    public get brand():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.brand;\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 客户端平台\r\n     */\r\n    public get platform():string\r\n    {\r\n        if(this.systemInfo)\r\n        {\r\n            return this.systemInfo.platform;\r\n        }\r\n    }\r\n\r\n    public get userData():any\r\n    {\r\n        return this._userData;\r\n    }\r\n\r\n    public get userInfo():any\r\n    {\r\n        return this._userInfo;\r\n    }\r\n\r\n    /**\r\n     * 微信唯一id\r\n     */\r\n    public get openid():string\r\n    {\r\n        if(this._tokenData)\r\n        {\r\n            return this._tokenData.openid;\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    public get token():string\r\n    {\r\n        if(this._tokenData)\r\n        {\r\n            return this._tokenData.skey;\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 用户在数据库里的id\r\n     */\r\n    public get uid():number\r\n    {\r\n        if(this._tokenData)\r\n        {\r\n            return this._tokenData.uid;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 用户是否是新用户\r\n     */\r\n    public get isNew():boolean\r\n    {\r\n        if(this._tokenData)\r\n        {\r\n            return this._tokenData.isNew;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 会话密匙 \r\n     */\r\n    public get session_key():string\r\n    {\r\n        if(this._accessTokenData)\r\n        {\r\n            return this._accessTokenData.session_key;\r\n        }\r\n\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 昵称\r\n     */\r\n    public get nickname():string\r\n    {\r\n        if(this._userInfo)\r\n        {\r\n            return this._userInfo.nickName;\r\n        }\r\n\r\n        return \"小飞刀\";\r\n    }\r\n\r\n    /**\r\n     * 授权状态\r\n    */\r\n    public get authorizeStatus(): AuthorizeStatus {\r\n        return this._authorizeStatus;\r\n    }\r\n\r\n    public get shareTicket():string\r\n    {\r\n        return this._shareTicket;\r\n    }\r\n\r\n    public get screenWidth():number\r\n    {\r\n        return this.systemInfo.screenWidth;\r\n    }\r\n\r\n    public get screenHeight():number\r\n    {\r\n        return this.systemInfo.screenHeight;\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param complete \r\n     * @param size 尺寸有 0、46、64、96、132 可选  0代表 640 * 640\r\n     */\r\n    public getUserIcon(complete:Function,size:number = 132)\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            complete(null);\r\n            return;\r\n        }\r\n        var avatarUrl:string = this._userInfo.avatarUrl;\r\n        var index = avatarUrl.lastIndexOf(\"/\");\r\n        avatarUrl = avatarUrl.substring(0,index + 1) + size + \"?aaa=aa.jpg\";\r\n\r\n        cc.loader.load(avatarUrl,(err,texture)=>\r\n        {\r\n            complete(texture);\r\n        });\r\n    }\r\n    \r\n    /**\r\n     * 申请用户授权\r\n     * @param success \r\n     * @param fail \r\n     */\r\n    public applyUserAuth(success:Function)\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            this._authorizeStatus = AuthorizeStatus.refuse;\r\n            success(false);\r\n            return;\r\n        }\r\n\r\n        this.wx.getSetting({\r\n\r\n            success:(res)=>\r\n            {\r\n                if(!res.authSetting[\"scope.userInfo\"])\r\n                {\r\n                    \r\n                    /*this.wx.authorize({\r\n\r\n                        scope:\"scope.userInfo\",\r\n\r\n                        success:(res)=>{\r\n                            this.wxLog(\"用户同意获取个人信息\");\r\n                            this._authorizeStatus = AuthorizeStatus.agree;\r\n                            success(true);\r\n                        },\r\n                        fail:(res)=>{\r\n                            this.wxLog(\"用户不同意获取个人信息\");\r\n                            //this._authorizeStatus = AuthorizeStatus.refuse;\r\n                            //success(false);\r\n\r\n                            var self:WXSdk = this;\r\n\r\n                            function showModal()\r\n                            {\r\n                                wx.showModal({\r\n                                  title: '警告',\r\n                                  content: '您点击了拒绝授权,游戏将无法正常显示个人信息,点击确定重新获取授权。',\r\n                                  success:function(res)\r\n                                    {\r\n                                        if (res.confirm)\r\n                                        {\r\n                                                wx.openSetting(\r\n                                                {\r\n                                                    success: (res) =>  \r\n                                                    {\r\n                                                      if (res.authSetting[\"scope.userInfo\"])\r\n                                                        {   ////如果用户重新同意了授权登录\r\n                                                            //console.log(\"被迫同意授权\");\r\n                                                            self._authorizeStatus = AuthorizeStatus.agree;\r\n                                                            success(true);\r\n                                                            \r\n                                                        }else\r\n                                                        {\r\n                                                            //console.log(\"用户还是拒绝\");\r\n                                                            showModal();\r\n                                                        }\r\n                                                    },  \r\n                                                    fail:function(res)\r\n                                                    {\r\n                                                        //console.log(\"打开面板失败\");\r\n                                                        showModal();\r\n                                                    }\r\n                                              })\r\n                                        }else\r\n                                        {\r\n                                            showModal();\r\n                                        }\r\n                                    }\r\n                                });\r\n                            }\r\n\r\n                            showModal();\r\n\r\n                        }\r\n                    });*/\r\n                    \r\n                    this.getUserAuthorizeBtn(success);\r\n\r\n                }else\r\n                {\r\n                    this._authorizeStatus = AuthorizeStatus.agree;\r\n                    success(true)\r\n                }\r\n                \r\n            },\r\n            fail:(res)=>\r\n            {\r\n                this._authorizeStatus = AuthorizeStatus.refuse;\r\n                success(false);\r\n            }\r\n        }\r\n        );\r\n    }\r\n\r\n    /*public openSetting(success:Function,fail:Function)\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            success({});\r\n            return;\r\n        }\r\n\r\n        this.wx.getSetting({\r\n            success:(res)=>\r\n            {\r\n                this.wxLog(\"open setting suc authSetting\",res.authSetting);\r\n            },\r\n            fail:(res)=>\r\n            {\r\n                this.wxLog(\"open setting fail \",res);\r\n            }\r\n        }\r\n        );\r\n    }*/\r\n\r\n    /**\r\n     * 创建按钮，打开用户权限申请页\r\n     */\r\n    public getUserAuthorizeBtn(success:Function)\r\n    {\r\n        console.log(this.systemInfo.screenWidth\r\n            );\r\n\r\n        var button = wx.createUserInfoButton({\r\n            type: 'text',\r\n            text: '',//'获取用户信息',\r\n            //image: 'res/raw-assets/7b/7bb27b49-7cfc-495d-aa3c-27f5c4234816.png',\r\n            style: {\r\n                left: 0,\r\n                top:  0,\r\n                width: this.systemInfo.screenWidth,\r\n                height: this.systemInfo.screenHeight,\r\n                lineHeight: 40,\r\n                backgroundColor: '#00000000',\r\n                color: '#ffffff',\r\n                textAlign: 'center',\r\n                fontSize: 16,\r\n                borderRadius: 4\r\n            }\r\n        });\r\n\r\n        button.onTap((res) => {\r\n            \r\n            if(res.errMsg == \"getUserInfo:ok\")\r\n            {\r\n                console.log(\"获得授权 ?\",res);\r\n                button.hide();\r\n                button.destroy();\r\n                success();\r\n            }else\r\n            {\r\n                \r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 微信登录\r\n     * @param success \r\n     * @param fail \r\n     */\r\n    public login(appid:string,secret:string,success:Function,fail:Function)\r\n    {\r\n\r\n        if(!this.wx)\r\n        {\r\n            success();\r\n            return;\r\n        }\r\n\r\n        this.appid = appid;\r\n        this.secret = secret;\r\n\r\n        if(this.isLogin)\r\n        {\r\n            success();\r\n            return;\r\n        }\r\n\r\n\r\n        var successCallback = ()=>{\r\n            this.isLogin = true;\r\n            WXSdk.instance.wx.hideLoading();\r\n            success();\r\n        };\r\n\r\n        var failCallback = ()=>{\r\n            WXSdk.instance.wx.hideLoading();\r\n            fail();\r\n        }\r\n\r\n\r\n        this.applyUserAuth((isAuthorize)=>\r\n        {\r\n            this.getUserInfo(()=>\r\n            {\r\n                //this.checkSession(success,fail);\r\n                this.loginWX(successCallback,failCallback);\r\n            },()=>\r\n            {\r\n                failCallback();\r\n            });\r\n\r\n        });\r\n    }\r\n\r\n\r\n    public loginWX(success:Function,fail:Function)\r\n    {\r\n        this.wx.showLoading({\r\n            title: '登录中...',\r\n            mask:true,\r\n            width:250,\r\n        });\r\n\r\n        this.wx.login({\r\n            timeout:30000,//登陆超时时间 单位ms\r\n            success:(res)=>{\r\n                this.wxLog(\"login\",res);\r\n                if(res.code)\r\n                {\r\n                    //console.log(\"code:\"+res.code)\r\n                    //this.getAccessToken(success,fail,res.code);\r\n                    //this.getAccessToken2(success,fail,res.code);\r\n\r\n                    success();\r\n\r\n                }else\r\n                {\r\n                    //this.wxLog(\"登录失败\",res);\r\n                    fail();\r\n                }\r\n            },\r\n            fail : (res)=>{\r\n                //this.wxLog(\"登录失败\",res);\r\n                fail();\r\n            },\r\n            complete(){\r\n                //调用结束时回掉，不管成功还是失败\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 检查登录状态是否过期\r\n     */\r\n    public checkSession(success:Function,fail:Function):void\r\n    {\r\n        this.wx.checkSession({\r\n            success:()=>\r\n            {\r\n                this.wxLog(\"session_key 未过期，并且在本生命周期一直有效\");\r\n                success();\r\n                //this.getUserInfo(success,fail);\r\n                //this.loginWX(success,fail);\r\n            },\r\n            fail:()=>\r\n            {\r\n                this.wxLog(\"已经失效，需要重新执行登录流程\");\r\n                this.loginWX(success,fail);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 登入凭证校验\r\n     */\r\n    private getAccessToken(success:Function,fail:Function,code:string):void\r\n    {\r\n        var obj:Object = \r\n        {\r\n            code: code,\r\n            // \"encrypted\": \"string\",\r\n            fromAppId: this.appid,\r\n            // \"fromType\": \"string\",\r\n            // \"fromUserId\": 0,\r\n            img: this._userInfo.avatarUrl,\r\n            // \"iv\": \"string\",\r\n            // \"model\": \"string\",\r\n            name: this.nickname,\r\n            // \"pf\": \"string\"\r\n        }\r\n\r\n        this.requestPost(this.url,obj,\r\n            (res:any)=>{\r\n                \r\n                this.wxLog(\"收到服务端返回数据\",res.data);\r\n\r\n                this._tokenData = res.data.data;\r\n\r\n                let errcode:number  = res.statusCode; //错误码\r\n\r\n                if (errcode == -1) \r\n                {\r\n                    //console.error(\">>>系统繁忙，此时请开发者稍候再试\");\r\n                    fail();\r\n                }else if (errcode == 0) \r\n                {\r\n                    //\">>>请求成功\");\r\n                    //this.getUserInfo(success,fail);\r\n                    success();\r\n                }else if (errcode == 200) \r\n                {\r\n                    //\">>>请求成功\");\r\n                    //this.getUserInfo(success,fail);\r\n                    success();\r\n                }\r\n                else if (errcode == 40029) \r\n                {\r\n                    //\">>>>code无效\");\r\n                    //this.getUserInfo(success,fail);\r\n                    success();\r\n                }else\r\n                {\r\n                    fail();\r\n                }\r\n            },\r\n            ()=>\r\n            {\r\n                console.error(\">>>>>>>获取登录凭证失败\");\r\n                fail();\r\n            }\r\n        );\r\n    }\r\n\r\n     /**\r\n     * 登入凭证校验\r\n     */\r\n    private getAccessToken2(success:Function,fail:Function,code:string):void\r\n    {\r\n        let url = \"https://api.weixin.qq.com/sns/jscode2session?appid={0}&secret={1}&js_code={2}&grant_type={3}\"; //这个请求似乎只能在服务器端完成，前端只能不校验合法域名才可以使用\r\n        url = SystemTools.format(url,this.appid,this.secret,code,this.grant_type); //拼接网址\r\n\r\n        //https://api.weixin.qq.com/sns/jscode2session?appid=wx472e16802f66329ajs_code=03329Yad2JudiF0Y9Vbd2Qh6bd229Ya3&grant_type=authorization_code\r\n\r\n        \r\n        this.requestGet(url,\r\n            (res:any)=>{\r\n                let data            = res.data;\r\n                let openId         = data.openid; //用户唯一标识\r\n                let session_key    = data.session_key; //回话密匙\r\n                //let errcode:number  = data.errcode; //错误码\r\n                let errcode:number  = res.statusCode; //错误码\r\n                let errMsg:string   = res.errMsg; //错误信息\r\n\r\n                this._accessTokenData = res.data;\r\n\r\n                this.wxLog(\"openId\",openId);\r\n                this.wxLog(\"session_key\",session_key);\r\n                this.wxLog(\"accesstoken res \",res,errcode);\r\n                if (errcode == -1) \r\n                {\r\n                    console.error(\">>>系统繁忙，此时请开发者稍候再试\");\r\n                }else if (errcode == 0) \r\n                {\r\n                    //\">>>请求成功\");\r\n                    this.getUserInfo(success,fail);\r\n                }else if (errcode == 200) \r\n                {\r\n                    //\">>>请求成功\");\r\n                    this.getUserInfo(success,fail);\r\n                }\r\n                else if (errcode == 40029) \r\n                {\r\n                    //\">>>>code无效\");\r\n                    this.getUserInfo(success,fail);\r\n                }\r\n            },\r\n            ()=>\r\n            {\r\n                console.error(\">>>>>>>获取登录凭证失败\");\r\n                fail();\r\n            }\r\n        );\r\n    }\r\n\r\n    /**\r\n     * 获取用户信息\r\n     */\r\n    private getUserInfo(success:Function,fail:Function):void\r\n    {\r\n        let data:any = \r\n        {\r\n            withCredentials:false,\r\n            lang:\"zh_CN\",\r\n            success:(res:any)=>\r\n            {\r\n                this._userData = res;\r\n                this._userInfo = res.userInfo;\r\n                this.wxLog(\"获取用户信息成功\");\r\n                success();\r\n            },\r\n            fail:(res:any)=>\r\n            {\r\n                this.wxLog(\"获取用户信息失败\",res);\r\n                fail();\r\n                //this.checkSession(success,fail); //获取用户信息失败之后 继续去获取\r\n                //this.wxLog(\"获取用户信息失败:\",this.tempCode);\r\n            }\r\n        }\r\n        wx.getUserInfo(data);\r\n    }\r\n\r\n    /**\r\n     * 微信请求\r\n     * @param url  请求地址\r\n     * @param successCallBack 成功回调\r\n     * @param failBack  失败回调\r\n     */\r\n    private requestGet(url:string,success:(res:any)=>void,fail:()=>void):void\r\n    {\r\n        let requestData:any = \r\n        {\r\n            url:url,\r\n            method:\"GET\",\r\n            dataType:\"json\",\r\n            success:(res:any)=>\r\n            {\r\n                success && success(res);   \r\n            },\r\n            fail:()=>\r\n            {\r\n                fail && fail();   \r\n                console.error(\">>>>>>请求url失败：\"+requestData.url);\r\n            }\r\n        };\r\n\r\n        this.wx.request(requestData);\r\n    }\r\n\r\n    private requestPost(url:string,data:{},success:(res:any)=>void,fail:()=>void)\r\n    {\r\n        let requestData:any = \r\n        {\r\n            url:url,\r\n            method:\"POST\",\r\n            data:data,\r\n            dataType:\"json\",\r\n            success:(res:any)=>\r\n            {\r\n                success && success(res);   \r\n            },\r\n            fail:()=>\r\n            {\r\n                fail && fail();   \r\n                console.error(\">>>>>>请求url失败：\"+requestData.url);\r\n            }\r\n        };\r\n\r\n        this.wx.request(requestData);\r\n    }\r\n\r\n\r\n    /**\r\n     * 设置用户排名数据存储\r\n     */\r\n    public setUserRankStorage(key:string,value:number|string)\r\n    {\r\n        if(!this.wx)\r\n            return;\r\n\r\n        var kvdatas:Array<Object> = [\r\n            {key:key,value:value.toString()},\r\n        ];\r\n\r\n        this.wx.setUserCloudStorage(\r\n            {KVDataList:kvdatas,\r\n            success(res){\r\n                console.log(\"setUserCloudStorage\",res);\r\n            }\r\n        });\r\n    }\r\n\r\n    public unloadUserScore(score:number,success:Function,fail:Function)\r\n    {\r\n\r\n        if(!this.wx)\r\n            return;\r\n\r\n        let url = this.worldRankUrl + `?id=${this.uid}&score=${score}`; //这个请求似乎只能在服务器端完成，前端只能不校验合法域名才可以使用\r\n\r\n        this.requestGet(url,\r\n            (res:any)=>{\r\n                \r\n                this.wxLog(\"上传用户数据返回\",res.data);\r\n\r\n                if (res.data.code == 0) \r\n                {\r\n                    success();\r\n                }\r\n                else\r\n                {\r\n                    fail();\r\n                }\r\n            },\r\n            ()=>\r\n            {\r\n                console.error(\"上传用户信息失败\");\r\n                fail();\r\n            }\r\n        );\r\n    }\r\n\r\n    public getUserScoreWorldRank(success:Function,fail:Function)\r\n    {\r\n\r\n        if(!this.wx)\r\n            return;\r\n\r\n        let url = this.worldRankUrl2 + this.uid; //这个请求似乎只能在服务器端完成，前端只能不校验合法域名才可以使用\r\n\r\n        this.requestGet(url,\r\n            (res:any)=>{\r\n                \r\n                this.wxLog(\"用户世界排行榜返回返回\",res);\r\n\r\n                if (res.data.code == 0) \r\n                {\r\n                    success(res.data.data);\r\n                }\r\n                else\r\n                {\r\n                    fail();\r\n                }\r\n            },\r\n            ()=>\r\n            {\r\n                console.error(\"上传用户信息失败\");\r\n                fail();\r\n            }\r\n        );\r\n\r\n    }\r\n\r\n    /**\r\n     * 分享游戏\r\n     */\r\n    public shareToAnyOne(success:Function,fail:Function)\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            success();\r\n            return;\r\n        }\r\n\r\n        var nowTime:number = Date.now()/1000;\r\n\r\n        if(nowTime - this.shareTime <= 3)\r\n        {\r\n            WXSdk.instance.wx.showModal({\r\n                title: '警告',\r\n                showCancel:false,\r\n                confirmText:\"确定\",\r\n                content: Math.random() < 0.5 ? '短时间内,不要分享同一个群' : '请换个群试试哦~~',\r\n                success:(res)=>\r\n                {\r\n                    if (res.confirm)\r\n                    {\r\n                        \r\n                    }else\r\n                    {\r\n                        \r\n                    }\r\n                }\r\n            });\r\n\r\n            fail();\r\n        }else\r\n        {\r\n            this.shareTime = nowTime;\r\n\r\n            var titleArr:string[] = [\r\n                \"今年4月最火的小游戏\",\r\n                \"玩转飞刀，坐拥地球！\",\r\n                \"提醒：@你的好友 已完成五杀\",\r\n                \"飞刀转转转，压力散散散！\",\r\n                \"我升星界大师了，你能打到宇宙最强吗？\"\r\n            ];\r\n    \r\n            var index:number = Math.floor((Math.random() * titleArr.length));\r\n    \r\n            this.wx.shareAppMessage({\r\n    \r\n                title: `${titleArr[index]}`,\r\n                imageUrl:\"https://knife-1258819150.file.myqcloud.com/image/%E6%98%9F%E7%90%83%E9%A3%9E%E5%88%80.jpg\",\r\n                query: \"type=shareToAnyOne\",\r\n    \r\n                success: function (res) {\r\n                    console.log('拉起分享 成功',res);\r\n                    success();\r\n                  },\r\n                  fail: function (res) {\r\n                    console.log('拉起分享 失败',res);\r\n                    fail();\r\n                  }\r\n    \r\n            });\r\n\r\n            this.scheduleOnce(()=>{\r\n\r\n                var currentTime:number = Date.now()/1000;\r\n\r\n                if(currentTime - nowTime <= 3)\r\n                {\r\n                    console.log(currentTime,nowTime,currentTime - nowTime);\r\n\r\n                    WXSdk.instance.wx.showModal({\r\n                        title: '警告',\r\n                        showCancel:false,\r\n                        confirmText:\"确定\",\r\n                        content: Math.random() < 0.5 ? '短时间内,不要分享同一个群' : '请换个群试试哦~~',\r\n                        success:(res)=>\r\n                        {\r\n                            if (res.confirm)\r\n                            {\r\n                                \r\n                            }else\r\n                            {\r\n                                \r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    return;\r\n                }\r\n\r\n\r\n                success();\r\n\r\n                WXSdk.instance.wx.showModal({\r\n                            title: '分享成功',\r\n                            showCancel:false,\r\n                            confirmText:\"确定\",\r\n                            content: '恭喜,获得奖励',\r\n                            success:(res)=>\r\n                            {\r\n                                if (res.confirm)\r\n                                {\r\n                                    \r\n                                }else\r\n                                {\r\n                                    \r\n                                }\r\n                            }\r\n                        });\r\n\r\n            },0.8);\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    public showVideo(adUnitId:string,close?:Function,success?:Function,fail?:Function)\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            close && close(1);\r\n            return;\r\n        }\r\n            \r\n\r\n        if(this.SDKVersion < \"2.04\")\r\n        {\r\n            console.log(\"基础库版本过低，不能使用视频广告功能\");\r\n            return;\r\n        }\r\n\r\n        var rewardedVideoAd = this.wx.createRewardedVideoAd({adUnitId:adUnitId}) //不支持在开发工具运行，只能在真机运行 返回值是个单例\r\n       \r\n        //this.wxLog(\"rewardedVideoAd\",rewardedVideoAd);\r\n\r\n        //视频广告默认是隐藏的，要调用show显示\r\n\r\n        rewardedVideoAd.onLoad(() => {\r\n            this.wxLog('激励视频 广告加载成功');\r\n            success && success();\r\n          });\r\n\r\n        rewardedVideoAd.onError(err => {\r\n            this.wxLog('激励视频 广告拉取失败',err);\r\n            fail && fail();\r\n        });\r\n\r\n        rewardedVideoAd.onClose(res=>{\r\n\r\n            rewardedVideoAd.offLoad();\r\n            rewardedVideoAd.offError();\r\n            rewardedVideoAd.offClose();\r\n            rewardedVideoAd = null;\r\n\r\n            // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n            if (res && res.isEnded || res === undefined)\r\n            {\r\n                //视频正常播放结束\r\n                close && close(1);\r\n            }else\r\n            {\r\n                //视频播放中途退出\r\n                close && close(0)\r\n            }\r\n        });\r\n\r\n        //开始加载视频广告\r\n        rewardedVideoAd.load().then(\r\n            ()=>\r\n            {\r\n                rewardedVideoAd.show().catch(\r\n                    err=>{\r\n\r\n                        this.wxLog('视频广告播放失败',err);\r\n\r\n                        rewardedVideoAd.offLoad();\r\n                        rewardedVideoAd.offError();\r\n                        rewardedVideoAd.offClose();\r\n                        rewardedVideoAd = null;\r\n\r\n                    }\r\n                    );\r\n            });\r\n\r\n    }\r\n\r\n\r\n    public showBanner(adUnitId:string,style:{})\r\n    {\r\n        if(!this.wx)\r\n            return;\r\n\r\n        this.removeBanner();\r\n        //banner默认隐藏，调用show方法显示\r\n        this._bannerAd = this.wx.createBannerAd(\r\n            {\r\n                adUnitId:adUnitId,\r\n                style:style\r\n                /*{\r\n                    left:10,\r\n                    top:60,\r\n                    width:400\r\n                }*/\r\n            }\r\n        );\r\n\r\n        this._bannerAd.onLoad(()=>{\r\n            this.wxLog(\"广告拉取成功\");\r\n        });\r\n\r\n        this._bannerAd.onError(err=>{\r\n            this.wxLog(\"广告拉取失败\",err);\r\n        });\r\n\r\n\r\n        this._bannerAd.onResize(res=>{\r\n            this._bannerAd.style.top = this.screenHeight - res.height;\r\n            this._bannerAd.style.width = this.screenWidth + 50;\r\n        });\r\n\r\n        this._bannerAd.show().then(()=>{this.wxLog(\"显示广告\")});\r\n\r\n        return this._bannerAd;\r\n        //bannerAd.hide();//切换到无广告页面时调用hide()\r\n    }\r\n\r\n    public showBottomBanner(adUnitId:string)\r\n    {\r\n        if(!this.wx)\r\n            return;\r\n\r\n        var style = \r\n        {\r\n            left:0,\r\n            top:this.screenHeight - 130,\r\n            width:this.screenWidth + 50,\r\n        }\r\n\r\n        WXSdk.instance.showBanner(adUnitId,style);\r\n        \r\n        /*this._bannerAd.hide();\r\n\r\n        this.scheduleOnce(()=>{\r\n\r\n            this._bannerAd.show();\r\n            this._bannerAd.style.top = this.screenHeight - this._bannerAd.style.realHeight;\r\n        },0.6);*/\r\n        \r\n    }\r\n\r\n\r\n    public removeBanner()\r\n    {\r\n        if(this._bannerAd)\r\n        {\r\n            this._bannerAd.offLoad();\r\n            this._bannerAd.offError();\r\n            this._bannerAd.offResize();\r\n            this._bannerAd.destroy(); //要先把旧的广告给销毁，不然会导致其监听的时间无法释放，影响性能\r\n            this._bannerAd = null;\r\n        }\r\n    }\r\n\r\n\r\n    update (dt) {}\r\n\r\n    /**\r\n     * 15ms的短震动\r\n     */\r\n    public vibrateShort()\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            return;\r\n        }\r\n\r\n        /*if(this.isVibrate)\r\n        {\r\n            return;\r\n        }*/\r\n\r\n        //this.isVibrate = true;\r\n\r\n        this.wx.vibrateShort({});\r\n\r\n        /*this.scheduleOnce(()=>\r\n        {\r\n            this.isVibrate = false;\r\n        },0.035);*/\r\n        \r\n    }\r\n\r\n    /**\r\n     * 400ms的长震动\r\n     */\r\n    public vibrateLong()\r\n    {\r\n        if(!this.wx)\r\n        {\r\n            return;\r\n        }\r\n\r\n        /*if(this.isVibrate)\r\n        {\r\n            return;\r\n        }*/\r\n\r\n\r\n        //this.isVibrate = true;\r\n\r\n        this.wx.vibrateLong({});\r\n\r\n        /*this.scheduleOnce(()=>\r\n        {\r\n            this.isVibrate = false;\r\n        },0.5);*/\r\n    }\r\n    \r\n    /**\r\n     * 获取小程序二维码\r\n     */\r\n    public createWXAQRCode()\r\n    {\r\n        this.wx.createWXAQRCode();\r\n    }\r\n\r\n    public getWXACode()\r\n    {\r\n        this.wx.getWXACode({});\r\n    }\r\n}\r\n"]}