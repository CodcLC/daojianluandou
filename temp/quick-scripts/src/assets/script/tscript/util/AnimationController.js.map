{"version":3,"sources":["assets\\script\\tscript\\util\\AnimationController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AnimationController extends cc.Component {\r\n\r\n    @property(cc.SpriteFrame)\r\n    public images:cc.SpriteFrame[] = [];\r\n\r\n    @property()\r\n    public frameTime:number = 0.1;\r\n\r\n    /// <summary>\r\n    /// 播放次数\r\n    /// </summary>\r\n    @property()\r\n    public playTimes:number = 0;\r\n\r\n    /// <summary>\r\n    /// 播放完自动销毁\r\n    /// </summary>\r\n    @property()\r\n    public autoDestroy:boolean = false;\r\n\r\n    public frameNum:number = 0;\r\n\r\n    public frameIndex:number = 0;\r\n\r\n\r\n    public running:boolean = true;\r\n\r\n    private m_render:cc.Sprite;\r\n\r\n    private time:number = 0;\r\n\r\n    private completeCallback:Function;\r\n\r\n    private frameCallback:Function;\r\n\r\n    private currentTimes:number = 0;\r\n\r\n    onLoad()\r\n    {\r\n        this.m_render = this.getComponent(cc.Sprite);\r\n    }\r\n\r\n\t// Use this for initialization\r\n\tstart () {\r\n        if (this.images.length != 0)\r\n        {\r\n            this.frameNum = this.images.length; \r\n        }\r\n\r\n        this.time = this.frameTime;\r\n\t}\r\n\t\r\n\t// Update is called once per frame\r\n    update (dt) {\r\n      \r\n        if (!this.running)\r\n            return;\r\n       \r\n        if (this.images.length == 0)\r\n            return;\r\n\r\n        this.time -= dt;\r\n\r\n        if (this.playTimes != 0 && this.currentTimes == this.playTimes)\r\n            return;\r\n\r\n        if (this.time <= 0)\r\n        {\r\n            this.time = this.frameTime;\r\n\r\n            this.frameIndex = this.frameIndex % this.frameNum;\r\n\r\n            this.m_render.spriteFrame = this.images[this.frameIndex];\r\n\r\n            if (this.frameCallback != null)\r\n            {\r\n                this.frameCallback(this.frameIndex);\r\n            }\r\n\r\n            if (this.frameIndex == this.frameNum - 1)\r\n            {\r\n                this.currentTimes++;\r\n\r\n                if (this.completeCallback != null)\r\n                {\r\n                    this.completeCallback();\r\n                }\r\n\r\n                if (this.autoDestroy)\r\n                {\r\n                    this.node.destroy();\r\n                }\r\n            }\r\n\r\n            this.frameIndex++;\r\n\r\n        }\r\n\t}\r\n\r\n    /// <summary>\r\n    /// 播放\r\n    /// </summary>\r\n    public play(completeCallback:Function = null, frameCallback:Function = null)\r\n    {\r\n        this.completeCallback = completeCallback;\r\n        this.frameCallback = frameCallback;\r\n\r\n        this.running = true;\r\n        this.frameIndex = 0;\r\n        this.currentTimes = 0;\r\n        this.time = this.frameTime;\r\n        if (this.images.length != 0)\r\n        {\r\n            this.frameNum = this.images.length;\r\n        }\r\n        if (this.m_render)\r\n            this.m_render.spriteFrame = this.images[0];\r\n\r\n    }\r\n\r\n    public gotoAndPlay(frameIndex:number)\r\n    {\r\n    }\r\n\r\n    /// <summary>\r\n    /// 停止\r\n    /// </summary>\r\n    public stop()\r\n    {\r\n        this.running = false;\r\n    }\r\n\r\n    public gotoAndStop(frameIndex:Function)\r\n    {\r\n        if (this.frameIndex < 0)\r\n            this.frameIndex = 0;\r\n\r\n        if (this.frameIndex > this.images.length - 1)\r\n            this.frameIndex = this.images.length - 1;\r\n\r\n        this.m_render.spriteFrame = this.images[this.frameIndex];\r\n\r\n        this.running = false;\r\n    }\r\n\r\n    public isPlayEnd():boolean\r\n    {\r\n        return this.frameIndex == this.frameNum;\r\n    }\r\n\r\n\r\n}\r\n"]}