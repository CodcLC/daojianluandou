{"version":3,"sources":["assets\\script\\tscript\\gamescene\\PlayerAI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Player, { PlayerStatus } from \"./Player\";\r\nimport Random from \"../util/Random\";\r\nimport GameManager, { GameStatus } from \"../core/GameManager\";\r\nimport GameScene from \"./GameScene\";\r\nimport Vector2 from \"../util/Vector2\";\r\nimport Mathf from \"../util/Mathf\";\r\nimport Knife from \"./Knife\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nexport enum PlayerAILevel\r\n{\r\n    none = 0,\r\n    level1 = 1,\r\n    level2 = 2,\r\n    level3 = 3,\r\n    level4 = 4,\r\n}\r\n\r\n@ccclass\r\nexport default class PlayerAI extends cc.Component {\r\n\r\n\r\n    public aiLevel:PlayerAILevel = PlayerAILevel.level1;\r\n\r\n    /**\r\n     * AI指令\r\n     */\r\n    public cmd:Command = new Command();\r\n\r\n    public player:Player = null;\r\n\r\n\r\n    private timer:number = 0.01;\r\n\r\n    /**\r\n     * 警戒范围\r\n     */\r\n    public alertRange:number = 1250;\r\n\r\n    public gameScene:GameScene = null;\r\n\r\n    onLoad () {\r\n        this.gameScene = this.node.parent.getComponent(GameScene);\r\n    }\r\n\r\n    start () {\r\n\r\n        this.player = this.getComponent(Player);\r\n\r\n        /*this.node.on(cc.Node.EventType.TOUCH_START,(event:cc.Event.EventTouch)=>{\r\n\r\n            if(this.player.isAI)\r\n            {\r\n                this.node.active = !this.node.active;\r\n            }\r\n            \r\n        },this);*/\r\n\r\n        this.cmd.Reset();\r\n\r\n    }\r\n\r\n    public onGameStart()\r\n    {\r\n\r\n        this.player = this.getComponent(Player);\r\n\r\n        if(this.aiLevel == PlayerAILevel.level1)\r\n        {\r\n            this.player.knifePool.initKnife(3);\r\n        }else if(this.aiLevel == PlayerAILevel.level2)\r\n        {\r\n            this.player.knifePool.initKnife(4);\r\n        }else if(this.aiLevel == PlayerAILevel.level3)\r\n        {\r\n            this.player.knifePool.initKnife(6);\r\n        }else if(this.aiLevel == PlayerAILevel.level4)\r\n        {\r\n            this.player.knifePool.initKnife(8);\r\n        }else\r\n        {\r\n            this.player.knifePool.initKnife(3);\r\n        }\r\n\r\n    }\r\n\r\n\r\n    update2 (dt) \r\n    {\r\n        if(GameManager.instance.gameStatus != GameStatus.start)\r\n        {\r\n            this.player.moveDir = cc.Vec2.ZERO;\r\n            return;\r\n        }\r\n\r\n        if(!this.player.isAI)\r\n        {\r\n            return;\r\n        }\r\n\r\n        this.timer -= dt;\r\n        \r\n        if(this.timer <= 0)\r\n        {\r\n            if(Random.Range(0,1) < 0.25)\r\n            {\r\n                if(this.player.status != PlayerStatus.defence)\r\n                {\r\n                    this.player.changeDefenceState();\r\n                }\r\n\r\n                this.player.moveDir = cc.Vec2.ZERO;\r\n\r\n            }else\r\n            {\r\n    \r\n                if(this.player.status != PlayerStatus.attack)\r\n                {\r\n                    this.player.changeAttackState();\r\n                }\r\n\r\n                this.player.moveDir = cc.v2(Random.Range(-1,1),Random.Range(-1,1));\r\n                \r\n            }\r\n\r\n            this.timer = Random.Range(1.0,2.0);\r\n        }\r\n    }\r\n\r\n\r\n    update(dt):void\r\n    {\r\n\r\n        if(GameManager.instance.gameStatus != GameStatus.start)\r\n        {\r\n            this.player.stopMove();\r\n            return;\r\n        }\r\n\r\n        if(!this.player.isAI)\r\n        {\r\n            return;\r\n        }\r\n\r\n \r\n        if (this.player.status == PlayerStatus.die)\r\n        {\r\n            this.player.stopMove();\r\n            return;\r\n        }\r\n            \r\n        this.cmd.Update(dt);\r\n\r\n        switch (this.cmd.type)\r\n        {\r\n            case CommandType.none:\r\n                this.OnWhatToDoNext(dt);\r\n                break;\r\n\r\n            case CommandType.pickKnife:\r\n                this.OnPickKnifeHandler(dt);\r\n                break;\r\n\r\n            case CommandType.patrol:\r\n                this.OnPatrolHandler(dt);\r\n                break;\r\n\r\n            case CommandType.scared:\r\n                this.OnScareHandler(dt);\r\n                break;\r\n\r\n            case CommandType.moveToTarget:\r\n                this.OnMoveToTargetHandler(dt);\r\n                break;\r\n\r\n            case CommandType.run:\r\n                this.OnRunHandler(dt);\r\n                break;\r\n\r\n            case CommandType.defenced:\r\n                this.OnDefencedHandler(dt);\r\n                break;\r\n\r\n            case CommandType.outflank:\r\n                this.OnOutflankHandler(dt);\r\n                break;\r\n\r\n            case CommandType.track:\r\n                this.OnTrackHandler(dt);\r\n                break;\r\n\r\n            case CommandType.attack:\r\n                this.OnAttackHandler(dt);\r\n                break;\r\n\r\n        }\r\n    }\r\n    \r\n    /// <summary>\r\n    /// 下一步做什么\r\n    /// </summary>\r\n    public OnWhatToDoNext(dt)\r\n    {\r\n        this.AnalysisEnvironment(dt);\r\n    }\r\n\r\n    /// <summary>\r\n    /// 捡刀命令的处理\r\n    /// </summary>\r\n    public OnPickKnifeHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Vector2.distance(this.player.node.position,this.cmd.targetPos) / this.player.getMoveSpeed();\r\n            this.player.moveToTarget(this.cmd.targetPos);\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n\r\n    }\r\n\r\n    //巡逻时处理\r\n    public OnPatrolHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            \r\n            //this.cmd.timer = Vector2.distance(this.player.node.position,this.cmd.targetPos) / this.player.getMoveSpeed();\r\n            //this.player.moveToTarget(this.cmd.targetPos);\r\n\r\n            this.cmd.timer = Random.Range(1, 2);\r\n            this.player.moveDir = cc.v2(Random.Range(-1,1),Random.Range(-1,1)).normalize();\r\n\r\n            this.player.changeAttackState();\r\n\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n            if (Vector2.distance(this.player.node.position,this.cmd.targetPos) <= this.player.getMoveSpeed() * dt)\r\n            {\r\n                this.cmd.process = CommandProcess.complete;\r\n            }\r\n        }\r\n    }\r\n\r\n    //惊吓时处理\r\n    public OnScareHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(5.25, 6.75);\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 逃跑时处理\r\n    /// </summary>\r\n    public OnRunHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(3.25, 5.0);\r\n            this.player.changeAttackState();\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n            this.player.moveDir = this.player.node.position.sub(this.cmd.targetPlayer.node.position).normalize();\r\n        }\r\n        \r\n    }\r\n\r\n    /// <summary>\r\n    /// 防御状态\r\n    /// </summary>\r\n    public OnDefencedHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(2, 4);\r\n\r\n            this.player.changeDefenceState();\r\n\r\n            this.player.stopMove();\r\n\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n        \r\n    }\r\n\r\n\r\n    /// <summary>\r\n    /// 迂回战术\r\n    /// </summary>\r\n    public OnOutflankHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(5.25, 6.75);\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 跟踪目标\r\n    /// </summary>\r\n    public  OnTrackHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(5.25, 6.75);\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n    }\r\n\r\n    //移动到目标处理\r\n    public OnMoveToTargetHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(5.25, 6.75);\r\n\r\n            this.player.changeAttackState();\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n           \r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 移动到目标完成\r\n    /// </summary>\r\n    public OnMoveToTargetComplete(target:Player)\r\n    {\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 目标进入攻击范围时\r\n    /// </summary>\r\n    /// <param name=\"target\"></param>\r\n    public OnTargetInAttackRange(target:Player)\r\n    {\r\n        \r\n    }\r\n\r\n    /// <summary>\r\n    /// 攻击处理\r\n    /// </summary>\r\n    public OnAttackHandler(dt:number)\r\n    {\r\n        if (this.cmd.process == CommandProcess.none)\r\n        {\r\n            this.cmd.process = CommandProcess.execute;\r\n            this.cmd.timer = Random.Range(2.25, 3.5);\r\n            this.player.changeAttackState();\r\n        }\r\n\r\n        if (this.cmd.process == CommandProcess.execute)\r\n        {\r\n            this.player.moveToTarget(this.cmd.targetPlayer.node.position)\r\n\r\n            if (Vector2.distance(this.player.node.position,this.cmd.targetPos) <= this.player.getMoveSpeed() * dt)\r\n            {\r\n                this.cmd.process = CommandProcess.complete;\r\n            }\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 分析环境\r\n    /// </summary>\r\n    protected AnalysisEnvironment(dt:number)\r\n    {\r\n        this.cmd.Reset(); //重置指令\r\n        this.cmd.timer = Random.Range(2.0,3.6);\r\n\r\n        switch(this.aiLevel)\r\n        {\r\n            case PlayerAILevel.level1:\r\n                this.AnalysisEnvironment_Level1(dt);\r\n            break;\r\n\r\n            case PlayerAILevel.level2:\r\n                this.AnalysisEnvironment_Level2(dt);\r\n            break;\r\n\r\n            case PlayerAILevel.level3:\r\n                this.AnalysisEnvironment_Level3(dt);\r\n            break;\r\n\r\n            case PlayerAILevel.level4:\r\n                this.AnalysisEnvironment_Level4(dt);\r\n            break;\r\n        }\r\n       \r\n    }\r\n\r\n    protected AnalysisEnvironment_Level1(dt:number)\r\n    {\r\n        if(Mathf.probability(0.25))\r\n        {\r\n            this.UseDefenseCmd();\r\n\r\n        }else\r\n        {\r\n            this.UsePatrolCmd();\r\n        }\r\n    }\r\n\r\n    protected AnalysisEnvironment_Level2(dt:number)\r\n    {\r\n\r\n        if(Mathf.probability(0.5))\r\n        {\r\n            var lastPlayer:Player = this.GetLastestPlayerInAlert(); //警戒范围距离最近的玩家\r\n            var myKfLen:number = this.player.knifePool.knifes.length;\r\n\r\n            if (lastPlayer != null)\r\n            {\r\n                var otherKflen:number = lastPlayer.knifePool.knifes.length;\r\n\r\n                if(myKfLen - otherKflen > 0)\r\n                {\r\n                    if(myKfLen < 8)\r\n                    {\r\n                        this.UsePickKnifeCmd();\r\n                    }else\r\n                    {\r\n                        this.UseAttackCmd(lastPlayer);\r\n                    }\r\n                }else\r\n                {\r\n                    if(Mathf.probability(0.4))\r\n                    {\r\n                        this.UseDefenseCmd();\r\n                    }else\r\n                    {\r\n                        this.UseRunCmd(lastPlayer);\r\n                    }\r\n                }\r\n\r\n            }else\r\n            {\r\n                this.UsePickKnifeCmd();\r\n            }\r\n\r\n        }else\r\n        {\r\n            this.UsePatrolCmd();\r\n        }\r\n    }\r\n\r\n    protected AnalysisEnvironment_Level3(dt:number)\r\n    {\r\n        if(Mathf.probability(0.7))\r\n        {\r\n            var lastPlayer:Player = this.GetLastestPlayerInAlert(); //警戒范围距离最近的玩家\r\n            var myKfLen:number = this.player.knifePool.knifes.length;\r\n\r\n            if (lastPlayer != null)\r\n            {\r\n                var otherKflen:number = lastPlayer.knifePool.knifes.length;\r\n\r\n                if(myKfLen - otherKflen > 0)\r\n                {\r\n                    if(myKfLen < 8)\r\n                    {\r\n                        this.UsePickKnifeCmd();\r\n                    }else\r\n                    {\r\n                        this.UseAttackCmd(lastPlayer);\r\n                    }\r\n                }else\r\n                {\r\n                    if(Mathf.probability(0.4))\r\n                    {\r\n                        this.UseDefenseCmd();\r\n                    }else\r\n                    {\r\n                        this.UseRunCmd(lastPlayer);\r\n                    }\r\n                }\r\n\r\n            }else\r\n            {\r\n                this.UsePickKnifeCmd();\r\n            }\r\n\r\n        }else\r\n        {\r\n            this.UsePatrolCmd();\r\n        }\r\n        \r\n    }\r\n\r\n    protected AnalysisEnvironment_Level4(dt:number)\r\n    {\r\n        var lastPlayer:Player = this.GetLastestPlayerInAlert(); //警戒范围距离最近的玩家\r\n\r\n        var myKfLen:number = this.player.knifePool.knifes.length;\r\n\r\n        if (lastPlayer != null)\r\n        {\r\n            var otherKflen:number = lastPlayer.knifePool.knifes.length;\r\n\r\n            if(myKfLen - otherKflen > 2)\r\n            {\r\n                if(myKfLen < 10)\r\n                {\r\n                    this.UsePickKnifeCmd();\r\n                }else\r\n                {\r\n                    this.UseAttackCmd(lastPlayer);\r\n                }\r\n            }else\r\n            {\r\n                if(Mathf.probability(0.4))\r\n                {\r\n                    this.UseDefenseCmd();\r\n                }else\r\n                {\r\n                    this.UseRunCmd(lastPlayer);\r\n                }\r\n            }\r\n\r\n        }else\r\n        {\r\n            this.UsePickKnifeCmd();\r\n        }\r\n    }\r\n\r\n\r\n    /// <summary>\r\n    /// 获得距离最近的玩家\r\n    /// </summary>\r\n    public GetLastestPlayer():Player\r\n    {\r\n        var playerArr:Array<Player> = this.gameScene.playerArr;\r\n\r\n        var lastPlayer:Player = null; //距离最近的玩家\r\n\r\n        var dis:number = 0;\r\n\r\n        playerArr.forEach((otherPlayer:Player)=>{\r\n\r\n            if (!otherPlayer)\r\n                return;\r\n\r\n            if (otherPlayer.status == PlayerStatus.die)\r\n                return;\r\n            \r\n            if(otherPlayer == this.player)\r\n                return;\r\n\r\n            var dis2:number = Vector2.distance(this.player.node.position,otherPlayer.node.position); //Vector3.Distance(m_transform.position, player.node.position);\r\n            \r\n            if (dis == 0)\r\n            {\r\n                dis = dis2;\r\n                lastPlayer = otherPlayer;\r\n            }\r\n            else\r\n            {\r\n                if (dis2 < dis)\r\n                {\r\n                    dis = dis2;\r\n                    lastPlayer = otherPlayer;\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        return lastPlayer;\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 获得警戒范围内距离最近的玩家\r\n    /// </summary>\r\n    public GetLastestPlayerInAlert():Player\r\n    {\r\n        var playerArr:Array<Player> = this.gameScene.playerArr;\r\n\r\n        var lastPlayer:Player = null; //距离最近的玩家\r\n\r\n        var dis:number = 0;\r\n\r\n        playerArr.forEach((otherPlayer:Player)=>{\r\n\r\n            if (!otherPlayer)\r\n                return;\r\n\r\n            if (otherPlayer.status == PlayerStatus.die)\r\n                return;\r\n            \r\n            if(otherPlayer == this.player)\r\n                return;\r\n            \r\n\r\n            var dis2:number = Vector2.distance(this.player.node.position,otherPlayer.node.position); //Vector3.Distance(m_transform.position, player.node.position);\r\n            \r\n            if (dis2 < this.alertRange)\r\n            {\r\n                if (dis == 0)\r\n                {\r\n                    dis = dis2;\r\n                    lastPlayer = otherPlayer;\r\n                }\r\n                else\r\n                {\r\n                    if (dis2 < dis)\r\n                    {\r\n                        dis = dis2;\r\n                        lastPlayer = otherPlayer;\r\n                    }\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        return lastPlayer;\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 获得随机一个玩家\r\n    /// </summary>\r\n    public GetRandomPlayer():Player\r\n    {\r\n        var playerArr:Array<Player> = this.gameScene.playerArr;\r\n\r\n        var tempPlayer:Player  = null;\r\n\r\n        var playerList:Array<Player> = [];\r\n\r\n        playerArr.forEach((otherPlayer:Player)=>{\r\n        \r\n            if (!otherPlayer)\r\n                return;\r\n\r\n            if (otherPlayer.status == PlayerStatus.die)\r\n                return;\r\n\r\n            if(otherPlayer == this.player)\r\n                return;\r\n\r\n            playerList.push(otherPlayer);\r\n        });\r\n\r\n        if (playerList.length != 0)\r\n            tempPlayer = playerList[Random.RangeInteger(0, playerList.length)];\r\n\r\n        return tempPlayer;\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 获得摄像机视野范围内随机一个点\r\n    /// </summary>\r\n    /// <returns></returns>\r\n    public GetRandomPointInScene():cc.Vec2\r\n    {\r\n\r\n        var halfWidth:number = this.gameScene.sceneSize.width / 2;\r\n        var halfHeight:number = this.gameScene.sceneSize.height / 2;\r\n\r\n        return cc.v2(Random.Range(-halfWidth,halfWidth),Random.Range(-halfHeight,halfHeight));\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 获得场景内距离玩家最近的一把飞刀\r\n    /// </summary>\r\n    public GetLastestKnife():Knife\r\n    {\r\n        var knifeArr:Array<Knife> = this.gameScene.knifeArr;\r\n\r\n        var lastKnife:Knife = null;\r\n\r\n        var dis:number = 0;\r\n\r\n        var halfWidth:number = this.gameScene.sceneSize.width / 2;\r\n        var halfHeight:number = this.gameScene.sceneSize.height / 2;\r\n\r\n        knifeArr.forEach((knife:Knife)=>{\r\n        \r\n\r\n            if(knife.node.x < -halfWidth || knife.node.x > halfWidth || knife.node.x < -halfHeight || knife.node.y > halfHeight)\r\n            {\r\n                return;\r\n            }\r\n\r\n            var dis2:number = Vector2.distance(this.player.node.position,knife.node.position); //Vector3.Distance(m_transform.position, player.node.position);\r\n            \r\n            if (dis2 < this.alertRange)\r\n            {\r\n                if (dis == 0)\r\n                {\r\n                    dis = dis2;\r\n                    lastKnife = knife;\r\n                }\r\n                else\r\n                {\r\n                    if (dis2 < dis)\r\n                    {\r\n                        dis = dis2;\r\n                        lastKnife = knife;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return lastKnife;\r\n\r\n    }\r\n\r\n\r\n    /// <summary>\r\n    /// 使用待机指令\r\n    /// </summary>\r\n    public  UsePickKnifeCmd()\r\n    {\r\n        this.cmd.type = CommandType.pickKnife;\r\n\r\n        var lastestKnife:Knife = this.GetLastestKnife();\r\n\r\n        if(lastestKnife)\r\n        {\r\n            this.cmd.targetPos = lastestKnife.node.position;\r\n        }else\r\n        {\r\n            this.cmd.targetPos = this.GetRandomPointInScene();\r\n        }\r\n\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用巡逻指令\r\n    /// </summary>\r\n    protected  UsePatrolCmd()\r\n    {\r\n        this.cmd.type = CommandType.patrol;\r\n        this.cmd.targetPos = this.GetRandomPointInScene();\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用防御指令\r\n    /// </summary>\r\n    protected  UseDefenseCmd()\r\n    {\r\n        this.cmd.type = CommandType.defenced;\r\n        //this.cmd.targetPlayer = player;\r\n        //this.cmd.targetPos = player.node.position;\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用攻击指令\r\n    /// </summary>\r\n    protected  UseAttackCmd(player:Player)\r\n    {\r\n\r\n        this.cmd.type = CommandType.attack;\r\n\r\n        if (player != null)\r\n        {\r\n            //enemy.FaceToPosition(player.node.position);\r\n            this.cmd.targetPlayer = player;\r\n            this.cmd.targetPos = player.node.position;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用攻击指令\r\n    /// </summary>\r\n    protected  UseRunCmd(player:Player)\r\n    {\r\n\r\n        this.cmd.type = CommandType.run;\r\n\r\n        if (player != null)\r\n        {\r\n            //enemy.FaceToPosition(player.node.position);\r\n            this.cmd.targetPlayer = player;\r\n            this.cmd.targetPos = player.node.position;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用移动到目标指令\r\n    /// </summary>\r\n    protected  UseMoveToTargetCmd(player:Player)\r\n    {\r\n        this.cmd.type = CommandType.moveToTarget;\r\n        this.cmd.targetPlayer = player;\r\n        this.cmd.targetPos = player.node.position;\r\n    }\r\n\r\n    /// <summary>\r\n    /// 使用跟踪目标指令\r\n    /// </summary>\r\n    protected  UseTrackCmd(player:Player)\r\n    {\r\n        this.cmd.type = CommandType.track;\r\n        this.cmd.targetPlayer = player;\r\n        this.cmd.targetPos = player.node.position;\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n/// <summary>\r\n/// 指令数据\r\n/// </summary>\r\n\r\nclass  Command\r\n{\r\n\r\n    /// <summary>\r\n    /// 指令类型\r\n    /// </summary>\r\n    public type:CommandType;\r\n\r\n    /// <summary>\r\n    /// 目标玩家对象\r\n    /// </summary>\r\n    public targetPlayer:Player;\r\n\r\n    /// <summary>\r\n    /// 目标点\r\n    /// </summary>\r\n    public targetPos:cc.Vec2;\r\n\r\n    /// <summary>\r\n    /// \r\n    /// </summary>\r\n    public roadPath:cc.Vec2[] = [];\r\n\r\n    /// <summary>\r\n    /// 指令执行时间\r\n    /// </summary>\r\n    public timer:number = 0;\r\n\r\n    public cd:number = 0;\r\n\r\n    /// <summary>\r\n    /// 执行进程\r\n    /// </summary>\r\n    public process:CommandProcess;\r\n\r\n    public Reset()\r\n    {\r\n        this.type = CommandType.none;\r\n        this.targetPlayer = null;\r\n        this.targetPos = cc.Vec2.ZERO;\r\n        this.roadPath.length = 0;\r\n        this.timer = 0;\r\n        this.cd = 0;\r\n        this.process = CommandProcess.none;\r\n    }\r\n\r\n    public Update(dt:number)\r\n    {\r\n        if(this.type == CommandType.moveToTarget || this.type == CommandType.outflank || this.type == CommandType.track)\r\n        {\r\n            if(!this.targetPlayer || this.targetPlayer.status == PlayerStatus.die) //玩家已经不存在\r\n                this.Reset();\r\n        }\r\n\r\n        if (this.process == CommandProcess.complete)\r\n        {\r\n            this.Reset();\r\n        }\r\n        else\r\n        {\r\n            if (this.timer > 0)\r\n            {\r\n                this.timer -= dt;\r\n\r\n                if (this.timer <= 0)\r\n                {\r\n                    this.Reset();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/// <summary>\r\n/// 指令类型\r\n/// </summary>\r\nenum CommandType\r\n{\r\n    /// <summary>\r\n    /// 不做任何事\r\n    /// </summary>\r\n    none = 0,\r\n\r\n    /// <summary>\r\n    /// 待机\r\n    /// </summary>\r\n    pickKnife = 1,\r\n\r\n    /// <summary>\r\n    /// 巡逻\r\n    /// </summary>\r\n    patrol = 2,\r\n\r\n    /// <summary>\r\n    /// 被惊吓\r\n    /// </summary>\r\n    scared = 3,\r\n\r\n    /// <summary>\r\n    /// 移动到目标\r\n    /// </summary>\r\n    moveToTarget = 4,\r\n\r\n    /// <summary>\r\n    /// 绕着走\r\n    /// </summary>\r\n    run = 5,\r\n\r\n    /// <summary>\r\n    /// 防御\r\n    /// </summary>\r\n    defenced = 6,\r\n\r\n    /// <summary>\r\n    /// 迂回\r\n    /// </summary>\r\n    outflank = 7,\r\n\r\n    /// <summary>\r\n    /// 跟踪\r\n    /// </summary>\r\n    track = 8,\r\n\r\n    /// <summary>\r\n    /// 组合攻击\r\n    /// </summary>\r\n    comboAttack = 100,\r\n\r\n    /// <summary>\r\n    /// 攻击1\r\n    /// </summary>\r\n    attack = 101,\r\n\r\n    /// <summary>\r\n    /// 攻击2\r\n    /// </summary>\r\n    attack2 = 102,\r\n\r\n    /// <summary>\r\n    /// 攻击3\r\n    /// </summary>\r\n    attack3 = 103,\r\n\r\n}\r\n\r\n/// <summary>\r\n/// 指令进程\r\n/// </summary>\r\nenum CommandProcess\r\n{\r\n    /// <summary>\r\n    /// 未执行\r\n    /// </summary>\r\n    none = 0,\r\n\r\n    /// <summary>\r\n    /// 执行中\r\n    /// </summary>\r\n    execute = 1,\r\n\r\n    /// <summary>\r\n    /// 执行完成\r\n    /// </summary>\r\n    complete = 2\r\n}\r\n\r\n"]}